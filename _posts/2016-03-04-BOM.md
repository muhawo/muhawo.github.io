---
layout: default
title: BOM-字节顺序标记
---

#BOM （字节顺序标记(ByteOrderMark)）

###首先解释一下字节顺序：  
字节顺序是指占内存多于一个字节类型的数据在内存中的存放顺序，通常有小端、大端两种字节顺序。  
小端字节序指低字节数据存放在内存低地址处，高字节数据存放在内存高地址处；大端字节序是高字节数据存放在低地址处，低字节数据存放在高地址处。  
例如“汉”字的Unicode编码是6C49。那么写到文件里时，究竟是将6C写在前面，还是将49写在前面？如果将6C写在前面，就是大端。还是将49写在前面，就是小端。

###BOM是个什么东西

BOM是一个字符，用来标示字节顺序是小端还是大端。这个字节应该出现在文件/字符流的开头，且没有宽度。英文名字叫做"Zero Width No-Break Space"。  
在Unicode编码中这个字符的编码是FEFF，FEFF的大端写法是11111110 11111111，小端写法是11111111 11111110，所以如果字符流的第一个字符是11111110 11111111表明字符序是大端，反之则为小端。

不同编码的BOM字符如下：

    UTF-8:      EF BB BF
    UTF-16:     FE FF
    UTF-32:     00 00 FE FF
    UTF-7:      2B 2F 76和以下的一个字节：[ 38 | 39 | 2B | 2F ]
    GB-18030:   84 31 95 33

###UTF-8不需要BOM

由于UTF-8是以字节序列来解析的，所以不存在大小端问题。UTF-8中的BOM（EF BB BF）只是用来表明使用的UTF-8编码格式，对字节顺序没有任何影响。  
UTF-16会每次取出两个字节作为一个字符来解析，才会有大小端问题。而UTF-8每次取一个字节进行解析，根据每个字符的规则判断一个就是一个字符还是需要取后面的字节组成字符。  
需不需要BOM的关键点在于处理字符流时是每次取多个还是取一个字节。

###为什么有的软件要求有BOM而又的软件坚决不能存在BOM

关于需不需要BOM只是针对UTF-8来说的，因为UTF-8可以有但是不需要BOM来标示字节序，而有些编辑软件又会自动添加BOM，才导致了这个问题的产生。  
比如PHP就没有考虑BOM的问题，把BOM标示当成了普通字符处理，[从而导致了一些问题的发生](http://afericazebra.blog.163.com/blog/static/30050408201211199298711/)。但有些地方对BOM提出了明确的需求，比如遨游浏览器扩展开发时的本地化文件中提出“语言文件的编码必须为Unicode或带 BOM 标志的 UTF-8格式.”

###参照文章：
[谈谈Unicode编码，简要解释UCS、UTF、BMP、BOM等名词](http://blog.csdn.net/fmddlmyy/article/details/372148)
[UTF-8, UTF-16, UTF-32 & BOM](http://unicode.org/faq/utf_bom.html)

